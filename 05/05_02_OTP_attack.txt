
Разбор техники

Обратим внимание на то, что в видео используется версия Burp Suite Pro, позволяющая использовать многопоточность в запросах. В бесплатной версии это невозможно. 

Ход действий

1. Переходим по адресу, который нашли при помощи техники перебора путей в веб-приложении: http://evil.corp:1337/admin/ и зайдем в административную панель, используя логин и пароль подобранные ранее.
см. картинку 05_02_panel

2. В интерфейсе ввода Second factor authentication укажем OTP 123 и проанализируем запрос в Burp:
см. картинку 05_02_BS01

3. Перенесем запрос в модуль Intruder (Правой кнопкой мыши на запрос или клавишами ctrl+i) и откроем его. Выберем значение 123 как позицию Payload. Укажем тип атаки – Sniper. Перейдем во вкладку Payloads, выберем Payload type – Numbers и укажем начальное и конечное значение для перебора – с 1 по 999. Также настроим формат числа с минимальным набором цифр в числе равным 3-м.
см. картинку 05_02_BS02

4. Запустим атаку. Дождемся ее исполнения и найдем ответ значение, которого изменилось с 200 OK на 303 See other, т.е. на перенаправление, ведущее на интерфейс панели администратора. Также обратим внимание на длину ответа, правильный код OTP был подобран и длина ответа стала равна 329. Все ответы с длинной 331 это уже повторные запросы, которые всегда вызывали перенаправление на следующую страницу. Вас может сбить с толку неправильный порядок, это происходит потому что Burp отправляет сразу много запросов в сеть и сервер отвечает на них не по порядку, поэтому запрос под номером 931 был обработан раньше чем 925.
см. картинку 05_02_BS03

5. Обновим страницу второго фактора в браузере, чтобы убедиться, что доступ получен:
см. картинку 05_02_BS04

6. Обратим внимание что для учащихся был спрятан способ обнаружить код установленный им для OTP в комментариях к старнице.
