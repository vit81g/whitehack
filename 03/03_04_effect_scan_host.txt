
Эффективность техники сканирования узлов сети

Эффективность техники измеряется в ее:

    Скорости
    Скрытности
    Качестве результатов

Как повысить эффективность техники

Повысить скорость сканирования на примере сканера Nmap можно:

1. Указав опцию -sn, говорящей nmap не делать сканирование портов после обнаружения узла. Таким образом, время не будет тратиться на сканирование множества портов, которые nmap сканирует по умолчанию и будет происходить чисто обнаружение узлов

2. Указав опцию -n, отключающей разрешение DNS-имен. По умолчанию при обнаружении узлов nmap также производит обратное DNS разрешение, для того, чтобы по найденным ip-адресам попробовать узнать их доменные имена. Это не всегда требуется, и отключение разрешения имен может ускорить процесс сканирования

3. Используя опции таймингов -T3, -T4, -T5, и т.д., которые изменяют интервал между сетевыми запросами (чем выше число, тем меньше интервалы между запросами и тем быстрее выполнится скан) Возможные варианты: paranoid(0), sneaky(1), polite(2), normal(3), aggressive(4) и insane(5). Первые два помогают уклоняться от идентификации атакующего. 2 режим замедляет сканирование. 3 режим это по умолчанию, то есть никакой оптимизации не будет по данному ключу. 4 режим ускоряет сканирование. 5 режим очень быстро сканирует, но есть вероятность в потере точности при сканировании. Пример: nmap -Т4 <example.com>.

Скрытность на примере сканера Nmap может быть повышена, если:

1. Использовать опцию --data-length <length>, добавляющей случайных байтов информации к каждому пакету, что помогает сделать сканирование менее заметным и более похожим на пакеты, генерируемые программой ping.

2. Добавить опцию --randomize-hosts, перемешивающую сканирование узлов, чтобы сделать сканирование менее подозрительным при анализе трафика

Качество результатов:

Повышается за счет использования разных видов сканирования, основанных на разных протоколах — таким образом, если некоторые протоколы фильтруются брандмауэром, результат можно получить, используя другие. Например, довольно часто системными администраторами блокируется трафик ICMP, в таком случае можно попробовать TCP/UDP сканирование.

Комбинации

Для наиболее сложных задач сканирования (например, при больших количествах) можно пользоваться комбинированием алгоритмов и инструментов: например, если целевая сеть большая и может содержать несколько подсетей, можно быстро прогнать MassScan по всей сети, чтобы определить подсети в ней, а затем уже по найденным подсетям меньшего размера идти nmap-ом

Пример использования MassScan:

masscan 10.0.0.0/8 192.168.0.0/16 172.16.0.0/12 -p80 --open-only

Здесь идет сканирование трех больших сетей 10.0.0.0/8, 192.168.0.0/16, 172.16.0.0/12 по 80 порту

Для повышения скрытности можно реализовать возможность использования фиктивных хостов (decoys) с опцией -D для того, чтобы скрыть IP-адрес атакующего от IDS/IPS систем.
